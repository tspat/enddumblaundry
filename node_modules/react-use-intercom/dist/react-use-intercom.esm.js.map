{"version":3,"file":"react-use-intercom.esm.js","sources":["../src/logger.ts","../src/utils.ts","../src/api.ts","../src/context.ts","../src/initialize.ts","../src/mappers.ts","../src/provider.tsx","../src/useIntercom.ts"],"sourcesContent":["import { LogLevel } from './types';\n\n/**\n * Logs messages in the console with a corresponding urgency\n *\n * @param level the urgency of the message\n * @param message the message to log in the console\n */\nexport const log = (level: LogLevel, message: string) => {\n  if (__DEV__) {\n    const packageName = '[react-use-intercom]';\n\n    switch (level) {\n      case 'info':\n        console.log(`${packageName} ${message}`);\n        break;\n      case 'warn':\n        console.warn(`${packageName} ${message}`);\n        break;\n      case 'error':\n        console.error(`${packageName} ${message}`);\n        break;\n      default:\n        console.log(`${packageName} ${message}`);\n    }\n  }\n};\n","export const isEmptyObject = (obj: object) =>\n  Object.keys(obj).length === 0 && obj.constructor === Object;\n\nexport const isSSR = typeof window === 'undefined';\n\n/**\n * Removes object entries where the value equals to `undefined`\n *\n * @param obj\n */\nexport const removeUndefined = (obj: any) => {\n  Object.keys(obj).forEach(key => {\n    if (obj[key] && typeof obj[key] === 'object') removeUndefined(obj[key]);\n    else if (obj[key] === undefined) delete obj[key];\n  });\n  return obj;\n};\n","import * as logger from './logger';\nimport { IntercomMethod } from './types';\nimport { isSSR } from './utils';\n\n/**\n * Safely exposes `window.Intercom` and passes the arguments to the instance\n *\n * @param method method passed to the `window.Intercom` instance\n * @param args arguments passed to the `window.Intercom` instance\n *\n * @see {@link https://developers.intercom.com/installing-intercom/docs/intercom-javascript}\n */\nconst IntercomAPI = (method: IntercomMethod, ...args: Array<any>) => {\n  if (!isSSR && window.Intercom) {\n    return window.Intercom.apply(null, [method, ...args]);\n  } else {\n    logger.log('error', `${method} Intercom instance is not initalized yet`);\n  }\n};\n\nexport default IntercomAPI;\n","import * as React from 'react';\n\nimport * as logger from './logger';\nimport { IntercomContextValues } from './types';\n\nconst NO_INTERCOM_PROVIDER_MESSAGE =\n  'Please wrap your component with `IntercomProvider`.';\n\nconst IntercomContext = React.createContext<IntercomContextValues>({\n  boot: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  shutdown: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  hardShutdown: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  update: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  hide: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  show: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  showMessages: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  showNewMessages: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  getVisitorId: () => {\n    logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE);\n    return '';\n  },\n  startTour: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n  trackEvent: () => logger.log('error', NO_INTERCOM_PROVIDER_MESSAGE),\n});\n\nexport default IntercomContext;\n","// @ts-nocheck\n/**\n * Snippet to initialize the Intercom instance\n *\n * @param appId - Intercom app id\n * @param [timeout=0] - Amount of milliseconds that the initialization should be delayed, defaults to 0\n *\n * @see {@link https://developers.intercom.com/installing-intercom/docs/basic-javascript}\n */\nconst initialize = (appId: string, timeout = 0) => {\n  var w = window;\n  var ic = w.Intercom;\n  if (typeof ic === 'function') {\n    ic('reattach_activator');\n    ic('update', w.intercomSettings);\n  } else {\n    var d = document;\n    var i = function() {\n      i.c(arguments);\n    };\n    i.q = [];\n    i.c = function(args) {\n      i.q.push(args);\n    };\n    w.Intercom = i;\n    var l = function() {\n      setTimeout(function() {\n        var s = d.createElement('script');\n        s.type = 'text/javascript';\n        s.async = true;\n        s.src = 'https://widget.intercom.io/widget/' + appId;\n        var x = d.getElementsByTagName('script')[0];\n        x.parentNode.insertBefore(s, x);\n      }, timeout);\n    };\n    if (document.readyState === 'complete') {\n      l();\n    } else if (w.attachEvent) {\n      w.attachEvent('onload', l);\n    } else {\n      w.addEventListener('load', l, false);\n    }\n  }\n};\n\nexport default initialize;\n","import {\n  DataAttributes,\n  DataAttributesAvatar,\n  DataAttributesCompany,\n  IntercomProps,\n  MessengerAttributes,\n  RawDataAttributes,\n  RawDataAttributesAvatar,\n  RawDataAttributesCompany,\n  RawIntercomProps,\n  RawMessengerAttributes,\n} from './types';\nimport { removeUndefined } from './utils';\n\nexport const mapMessengerAttributesToRawMessengerAttributes = (\n  attributes: MessengerAttributes,\n): RawMessengerAttributes => ({\n  custom_launcher_selector: attributes.customLauncherSelector,\n  alignment: attributes.alignment,\n  vertical_padding: attributes.verticalPadding,\n  horizontal_padding: attributes.horizontalPadding,\n  hide_default_launcher: attributes.hideDefaultLauncher,\n  session_duration: attributes.sessionDuration,\n  action_color: attributes.actionColor,\n  background_color: attributes.backgroundColor,\n});\n\nconst mapDataAttributesCompanyToRawDataAttributesCompany = (\n  attributes: DataAttributesCompany,\n): RawDataAttributesCompany => ({\n  company_id: attributes.companyId,\n  name: attributes.name,\n  created_at: attributes.createdAt,\n  plan: attributes.plan,\n  monthly_spend: attributes.monthlySpend,\n  user_count: attributes.userCount,\n  size: attributes.size,\n  website: attributes.website,\n  industry: attributes.industry,\n  ...attributes.customAttributes,\n});\n\nconst mapDataAttributesAvatarToRawDataAttributesAvatar = (\n  attributes: DataAttributesAvatar,\n): RawDataAttributesAvatar => ({\n  type: attributes.type,\n  image_url: attributes.imageUrl,\n});\n\nexport const mapDataAttributesToRawDataAttributes = (\n  attributes: DataAttributes,\n): RawDataAttributes => ({\n  email: attributes.email,\n  user_id: attributes.userId,\n  created_at: attributes.createdAt,\n  name: attributes.name,\n  phone: attributes.phone,\n  last_request_at: attributes.lastRequestAt,\n  unsubscribed_from_emails: attributes.unsubscribedFromEmails,\n  language_override: attributes.languageOverride,\n  utm_campaign: attributes.utmCampaign,\n  utm_content: attributes.utmContent,\n  utm_medium: attributes.utmMedium,\n  utm_source: attributes.utmSource,\n  utm_term: attributes.utmTerm,\n  avatar:\n    attributes.avatar &&\n    mapDataAttributesAvatarToRawDataAttributesAvatar(attributes.avatar),\n  user_hash: attributes.userHash,\n  company:\n    attributes.company &&\n    mapDataAttributesCompanyToRawDataAttributesCompany(attributes.company),\n  companies: attributes.companies?.map(\n    mapDataAttributesCompanyToRawDataAttributesCompany,\n  ),\n  ...attributes.customAttributes,\n});\n\nexport const mapIntercomPropsToRawIntercomProps = (\n  props: IntercomProps,\n): RawIntercomProps => {\n  return removeUndefined({\n    ...mapMessengerAttributesToRawMessengerAttributes(props),\n    ...mapDataAttributesToRawDataAttributes(props),\n  });\n};\n","import * as React from 'react';\n\nimport IntercomAPI from './api';\nimport IntercomContext from './context';\nimport initialize from './initialize';\nimport * as logger from './logger';\nimport { mapIntercomPropsToRawIntercomProps } from './mappers';\nimport {\n  IntercomContextValues,\n  IntercomProps,\n  IntercomProviderProps,\n  RawIntercomBootProps,\n} from './types';\nimport { isEmptyObject, isSSR } from './utils';\n\nexport const IntercomProvider: React.FC<IntercomProviderProps> = ({\n  appId,\n  autoBoot = false,\n  autoBootProps,\n  children,\n  onHide,\n  onShow,\n  onUnreadCountChange,\n  shouldInitialize = !isSSR,\n  apiBase,\n  initializeDelay,\n  ...rest\n}) => {\n  const isBooted = React.useRef(false);\n  const isInitialized = React.useRef(false);\n\n  if (!isEmptyObject(rest) && __DEV__)\n    logger.log(\n      'error',\n      [\n        'some invalid props were passed to IntercomProvider. ',\n        `Please check following props: ${Object.keys(rest).join(', ')}.`,\n      ].join(''),\n    );\n\n  const boot = React.useCallback(\n    (props?: IntercomProps) => {\n      if (!window.Intercom && !shouldInitialize) {\n        logger.log(\n          'warn',\n          'Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`',\n        );\n        return;\n      }\n\n      if (isBooted.current) {\n        return;\n      }\n\n      const metaData: RawIntercomBootProps = {\n        app_id: appId,\n        ...(apiBase && { api_base: apiBase }),\n        ...(props && mapIntercomPropsToRawIntercomProps(props)),\n      };\n\n      window.intercomSettings = metaData;\n      IntercomAPI('boot', metaData);\n      isBooted.current = true;\n    },\n    [apiBase, appId, shouldInitialize],\n  );\n\n  if (!isSSR && shouldInitialize && !isInitialized.current) {\n    initialize(appId, initializeDelay);\n\n    // attach listeners\n    if (onHide) IntercomAPI('onHide', onHide);\n    if (onShow) IntercomAPI('onShow', onShow);\n    if (onUnreadCountChange)\n      IntercomAPI('onUnreadCountChange', onUnreadCountChange);\n\n    if (autoBoot) {\n      boot(autoBootProps);\n    }\n\n    isInitialized.current = true;\n  }\n\n  const ensureIntercom = React.useCallback(\n    (\n      functionName: string = 'A function',\n      callback: (() => void) | (() => string),\n    ) => {\n      if (!window.Intercom && !shouldInitialize) {\n        logger.log(\n          'warn',\n          'Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`',\n        );\n        return;\n      }\n      if (!isBooted.current) {\n        logger.log(\n          'warn',\n          [\n            `'${functionName}' was called but Intercom has not booted yet. `,\n            `Please call 'boot' before calling '${functionName}' or `,\n            `set 'autoBoot' to true in the IntercomProvider.`,\n          ].join(''),\n        );\n        return;\n      }\n      return callback();\n    },\n    [shouldInitialize],\n  );\n\n  const shutdown = React.useCallback(() => {\n    if (!isBooted.current) return;\n\n    IntercomAPI('shutdown');\n    isBooted.current = false;\n  }, []);\n\n  const hardShutdown = React.useCallback(() => {\n    if (!isBooted.current) return;\n\n    IntercomAPI('shutdown');\n    delete window.Intercom;\n    delete window.intercomSettings;\n    isBooted.current = false;\n  }, []);\n\n  const refresh = React.useCallback(() => {\n    ensureIntercom('update', () => {\n      const lastRequestedAt = new Date().getTime();\n      IntercomAPI('update', { last_requested_at: lastRequestedAt });\n    });\n  }, [ensureIntercom]);\n\n  const update = React.useCallback(\n    (props?: IntercomProps) => {\n      ensureIntercom('update', () => {\n        if (!props) {\n          refresh();\n          return;\n        }\n        const rawProps = mapIntercomPropsToRawIntercomProps(props);\n        window.intercomSettings = { ...window.intercomSettings, ...rawProps };\n        IntercomAPI('update', rawProps);\n      });\n    },\n    [ensureIntercom, refresh],\n  );\n\n  const hide = React.useCallback(() => {\n    ensureIntercom('hide', () => {\n      IntercomAPI('hide');\n    });\n  }, [ensureIntercom]);\n\n  const show = React.useCallback(() => {\n    ensureIntercom('show', () => IntercomAPI('show'));\n  }, [ensureIntercom]);\n\n  const showMessages = React.useCallback(() => {\n    ensureIntercom('showMessages', () => {\n      IntercomAPI('showMessages');\n    });\n  }, [ensureIntercom]);\n\n  const showNewMessages = React.useCallback(\n    (message?: string) => {\n      ensureIntercom('showNewMessage', () => {\n        if (!message) {\n          IntercomAPI('showNewMessage');\n        } else {\n          IntercomAPI('showNewMessage', message);\n        }\n      });\n    },\n    [ensureIntercom],\n  );\n\n  const getVisitorId = React.useCallback(() => {\n    return ensureIntercom('getVisitorId', () => {\n      return IntercomAPI('getVisitorId');\n    }) as string;\n  }, [ensureIntercom]);\n\n  const startTour = React.useCallback(\n    (tourId: number) => {\n      ensureIntercom('startTour', () => {\n        IntercomAPI('startTour', tourId);\n      });\n    },\n    [ensureIntercom],\n  );\n\n  const trackEvent = React.useCallback(\n    (event: string, metaData?: object) => {\n      ensureIntercom('trackEvent', () => {\n        if (metaData) {\n          IntercomAPI('trackEvent', event, metaData);\n        } else {\n          IntercomAPI('trackEvent', event);\n        }\n      });\n    },\n    [ensureIntercom],\n  );\n\n  const providerValue = React.useMemo<IntercomContextValues>(() => {\n    return {\n      boot,\n      shutdown,\n      hardShutdown,\n      update,\n      hide,\n      show,\n      showMessages,\n      showNewMessages,\n      getVisitorId,\n      startTour,\n      trackEvent,\n    };\n  }, [\n    boot,\n    shutdown,\n    hardShutdown,\n    update,\n    hide,\n    show,\n    showMessages,\n    showNewMessages,\n    getVisitorId,\n    startTour,\n    trackEvent,\n  ]);\n\n  const content = React.useMemo(() => children, [children]);\n\n  return (\n    <IntercomContext.Provider value={providerValue}>\n      {content}\n    </IntercomContext.Provider>\n  );\n};\n\nexport const useIntercomContext = () => React.useContext(IntercomContext);\n","import { useIntercomContext } from './provider';\n\nexport const useIntercom = () => {\n  return useIntercomContext();\n};\n"],"names":["log","level","message","packageName","console","warn","error","isEmptyObject","obj","Object","keys","length","constructor","isSSR","window","removeUndefined","forEach","key","undefined","IntercomAPI","method","Intercom","args","apply","logger","NO_INTERCOM_PROVIDER_MESSAGE","IntercomContext","React","boot","shutdown","hardShutdown","update","hide","show","showMessages","showNewMessages","getVisitorId","startTour","trackEvent","initialize","appId","timeout","w","ic","intercomSettings","d","document","i","c","arguments","q","push","l","setTimeout","s","createElement","type","async","src","x","getElementsByTagName","parentNode","insertBefore","readyState","attachEvent","addEventListener","mapMessengerAttributesToRawMessengerAttributes","attributes","custom_launcher_selector","customLauncherSelector","alignment","vertical_padding","verticalPadding","horizontal_padding","horizontalPadding","hide_default_launcher","hideDefaultLauncher","session_duration","sessionDuration","action_color","actionColor","background_color","backgroundColor","mapDataAttributesCompanyToRawDataAttributesCompany","company_id","companyId","name","created_at","createdAt","plan","monthly_spend","monthlySpend","user_count","userCount","size","website","industry","customAttributes","mapDataAttributesAvatarToRawDataAttributesAvatar","image_url","imageUrl","mapDataAttributesToRawDataAttributes","email","user_id","userId","phone","last_request_at","lastRequestAt","unsubscribed_from_emails","unsubscribedFromEmails","language_override","languageOverride","utm_campaign","utmCampaign","utm_content","utmContent","utm_medium","utmMedium","utm_source","utmSource","utm_term","utmTerm","avatar","user_hash","userHash","company","companies","map","mapIntercomPropsToRawIntercomProps","props","IntercomProvider","autoBoot","autoBootProps","children","onHide","onShow","onUnreadCountChange","shouldInitialize","apiBase","initializeDelay","rest","isBooted","isInitialized","join","current","metaData","app_id","api_base","ensureIntercom","functionName","callback","refresh","lastRequestedAt","Date","getTime","last_requested_at","rawProps","tourId","event","providerValue","content","Provider","value","useIntercomContext","useIntercom"],"mappings":"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"}